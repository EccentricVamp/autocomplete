!function(e,t){"function"==typeof define&&define.amd?define("WebAutocomplete",[],t):"object"==typeof exports?module.exports=t(require,exports):t(null,e)}(this,function(e,t){"use strict";function n(e){function t(){y++,m=[],u=void 0,h.display="none"}function n(){for(;p.firstChild;)p.removeChild(p.firstChild);if(m.forEach(function(n){var i=v.createElement("div");i.textContent=n.label,n===u&&(i.className="selected"),i.addEventListener("click",function(i){e.itemSelected(n.item,a),t(),i.preventDefault(),i.stopPropagation()}),p.appendChild(i)}),e.emptyMsg&&m.length<1){var n=v.createElement("div");n.className="empty",n.textContent=e.emptyMsg,p.appendChild(n)}var i=a.getBoundingClientRect(),l=i.top+a.offsetHeight;h.top=l+"px",h.left=i.left+"px",h.width=a.offsetWidth+"px",h.maxHeight=window.innerHeight-l+"px",h.height="auto",h.display="block",o()}function i(i){var o=i.which||i.keyCode||0,l=++y;if(38!==o&&40!==o&&13!==o){if(27===o)return void t();a.value.length>=g?a.value!==c&&e.fetch(a.value,function(e){y===l&&e&&(m=e,u=m.length>0?m[0]:void 0,n())}):t(),c=a.value}}function o(){var e=p.getElementsByClassName("selected");if(e.length>0){var t=e[0];if(t.offsetTop<p.scrollTop)p.scrollTop=t.offsetTop;else{var n=t.offsetTop+t.offsetHeight,i=p.scrollTop+p.offsetHeight;n>i&&(p.scrollTop+=n-i)}}}function l(){if(m.length<1)u=void 0;else if(u===m[0])u=m[m.length-1];else for(var e=m.length-1;e>0;e--)if(u===m[e]||1===e){u=m[e-1];break}}function r(){if(m.length<1&&(u=void 0),!u||u===m[m.length-1])return void(u=m[0]);for(var e=0;e<m.length-1;e++)if(u===m[e]){u=m[e+1];break}}function f(i){var o=i.which||i.keyCode||0;return 38===o||40===o?(38===o?l():r(),n(),void i.preventDefault()):void(13===o&&u&&(e.itemSelected(u.item,a),t()))}function d(){setTimeout(function(){v.activeElement!==a&&t()},100)}function s(){a.removeEventListener("keydown",f),a.removeEventListener("keyup",i),a.removeEventListener("focus",i),a.removeEventListener("blur",d),t();var e=p.parentNode;e&&e.removeChild(p)}var a,u,c,v=document,p=v.createElement("div"),h=p.style,m=[],g=e.minLength||2,y=0;if(!e.input)throw"input undefined";return a=e.input,c=a.value,v.body.appendChild(p),p.className="autocomplete "+(e.className||""),h.position="absolute",a.addEventListener("keydown",f),a.addEventListener("keyup",i),a.addEventListener("focus",i),a.addEventListener("blur",d),{destroy:s}}t.WebAutocomplete=n});