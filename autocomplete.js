!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){var e=C.parentNode;e&&e.removeChild(C)}function n(){C.parentNode||y.body.appendChild(C)}function o(){return!!C.parentNode}function r(){N++,x=[],L="",g=void 0,t()}function i(){for(;C.firstChild;)C.removeChild(C.firstChild);var t=!1,o="#9?$";x.forEach(function(e){e.group&&(t=!0)});var i=function(e,t){var n=y.createElement("div");return n.textContent=e.label||"",n};e.render&&(i=e.render);var l=function(e,t){var n=y.createElement("div");return n.textContent=e,n};e.renderGroup&&(l=e.renderGroup);var f=y.createDocumentFragment();if(x.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var n=l(t.group,L);n&&(n.className+=" group",f.appendChild(n))}var d=i(t,L);d&&(d.addEventListener("click",function(n){e.onSelect(t,h),r(),n.preventDefault(),n.stopPropagation()}),t===g&&(d.className+=" selected"),f.appendChild(d))}),C.appendChild(f),x.length<1){if(!e.emptyMsg)return void r();var d=y.createElement("div");d.className="empty",d.textContent=e.emptyMsg,C.appendChild(d)}n();var a=h.getBoundingClientRect(),s=a.top+h.offsetHeight+(y.documentElement?y.documentElement.scrollTop:0);w.top=s+"px",w.left=a.left+"px",w.width=h.offsetWidth+"px",w.maxHeight=window.innerHeight-(a.top+h.offsetHeight)+"px",w.height="auto",u()}function l(){o()&&i()}function f(){l()}function d(){l()}function a(t){for(var n=t.which||t.keyCode||0,l=++N,f=[38,13,27,39,37,16,17,18,20,91,9],d=0,a=f;d<a.length;d++){if(n===a[d])return}if(40!==n||!o()){var u=h.value;u.length>=b?e.fetch(u,function(e){N===l&&e&&!E&&(x=e,L=u,g=x.length>0?x[0]:void 0,i())}):r()}}function u(){var e=C.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<C.scrollTop)C.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,r=C.scrollTop+C.offsetHeight;o>r&&(C.scrollTop+=o-r)}}}function s(){if(x.length<1)g=void 0;else if(g===x[0])g=x[x.length-1];else for(var e=x.length-1;e>0;e--)if(g===x[e]||1===e){g=x[e-1];break}}function c(){if(x.length<1&&(g=void 0),!g||g===x[x.length-1])return void(g=x[0]);for(var e=0;e<x.length-1;e++)if(g===x[e]){g=x[e+1];break}}function p(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var l=o();if(27===n)r();else{if(!o||x.length<1)return;38===n?s():c(),i()}return t.preventDefault(),void(l&&t.stopPropagation())}13===n&&g&&(e.onSelect(g,h),r())}function v(){setTimeout(function(){y.activeElement!==h&&r()},200)}function m(){E=!0,h.removeEventListener("keydown",p),h.removeEventListener("keyup",a),h.removeEventListener("blur",v),window.removeEventListener("resize",f),document.removeEventListener("scroll",d,!0),r()}var h,g,E,y=document,C=y.createElement("div"),w=C.style,x=[],L="",b=e.minLength||2,N=0;if(!e.input)throw new Error("input undefined");return h=e.input,C.className="autocomplete "+(e.className||""),w.position="absolute",h.addEventListener("keydown",p),h.addEventListener("keyup",a),h.addEventListener("blur",v),window.addEventListener("resize",f),document.addEventListener("scroll",d,!0),{destroy:m}}return e});