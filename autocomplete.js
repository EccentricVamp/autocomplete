!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){return"none"!==y.display}function n(){L++,w=[],C="",m=void 0,y.display="none"}function o(){for(;E.firstChild;)E.removeChild(E.firstChild);var t=!1,o="#9?$";w.forEach(function(e){e.group&&(t=!0)});var i=function(e,t){var n=g.createElement("div");return n.textContent=e.label,n};e.render&&(i=e.render);var r=function(e,t){var n=g.createElement("div");return n.textContent=e,n};if(e.renderGroup&&(r=e.renderGroup),w.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var l=r(t.group,C);l&&(l.className+=" group",E.appendChild(l))}var f=i(t,C);f&&(f.addEventListener("click",function(o){e.onSelect(t.item,v),n(),o.preventDefault(),o.stopPropagation()}),t===m&&(f.className+=" selected"),E.appendChild(f))}),w.length<1){if(!e.emptyMsg)return void n();var l=g.createElement("div");l.className="empty",l.textContent=e.emptyMsg,E.appendChild(l)}var f=v.getBoundingClientRect(),a=f.top+v.offsetHeight+g.documentElement.scrollTop;y.top=a+"px",y.left=f.left+"px",y.width=v.offsetWidth+"px",y.maxHeight=window.innerHeight-(f.top+v.offsetHeight)+"px",y.height="auto",y.display="block",d()}function i(){t()&&o()}function r(){i()}function l(){i()}function f(i){for(var r=i.which||i.keyCode||0,l=++L,f=[38,13,27,39,37,16,17,18,20,91,9],d=0,a=f;d<a.length;d++){if(r===a[d])return}if(40!==r||!t()){var s=v.value;s.length>=x?e.fetch(s,function(e){L===l&&e&&!h&&(w=e,C=s,m=w.length>0?w[0]:void 0,o())}):n()}}function d(){var e=E.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<E.scrollTop)E.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=E.scrollTop+E.offsetHeight;o>i&&(E.scrollTop+=o-i)}}}function a(){if(w.length<1)m=void 0;else if(m===w[0])m=w[w.length-1];else for(var e=w.length-1;e>0;e--)if(m===w[e]||1===e){m=w[e-1];break}}function s(){if(w.length<1&&(m=void 0),!m||m===w[w.length-1])return void(m=w[0]);for(var e=0;e<w.length-1;e++)if(m===w[e]){m=w[e+1];break}}function u(i){var r=i.which||i.keyCode||0;if(38===r||40===r||27===r){var l=t();if(27===r)n();else{if(!t||w.length<1)return;38===r?a():s(),o()}return i.preventDefault(),void(l&&i.stopPropagation())}13===r&&m&&(e.onSelect(m.item,v),n())}function c(){setTimeout(function(){g.activeElement!==v&&n()},200)}function p(){h=!0,v.removeEventListener("keydown",u),v.removeEventListener("keyup",f),v.removeEventListener("blur",c),window.removeEventListener("resize",r),document.removeEventListener("scroll",l,!0),n();var e=E.parentNode;e&&e.removeChild(E)}var v,m,h,g=document,E=g.createElement("div"),y=E.style,w=[],C="",x=e.minLength||2,L=0;if(!e.input)throw new Error("input undefined");return v=e.input,g.body.appendChild(E),E.className="autocomplete "+(e.className||""),y.position="absolute",y.display="none",v.addEventListener("keydown",u),v.addEventListener("keyup",f),v.addEventListener("blur",c),window.addEventListener("resize",r),document.addEventListener("scroll",l,!0),{destroy:p}}return e});