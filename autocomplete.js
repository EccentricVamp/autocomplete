!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){var e=x.parentNode;e&&e.removeChild(x)}function n(){x.parentNode||y.body.appendChild(x)}function o(){return!!x.parentNode}function i(){H++,N=[],k="",E=void 0,t()}function r(){var e=y.documentElement,t=e.clientTop||y.body.clientTop||0,n=e.clientLeft||y.body.clientLeft||0,o=window.pageYOffset||e.scrollTop,i=window.pageXOffset||e.scrollLeft,r=h.getBoundingClientRect(),f=r.top+h.offsetHeight+o-t,l=r.left+i-n;C.top=f+"px",C.left=l+"px",C.width=h.offsetWidth+"px",C.maxHeight=window.innerHeight-f+"px",C.height="auto"}function f(){for(;x.firstChild;)x.removeChild(x.firstChild);var t=!1,o="#9?$";N.forEach(function(e){e.group&&(t=!0)});var f=function(e,t){var n=y.createElement("div");return n.textContent=e.label||"",n};e.render&&(f=e.render);var l=function(e,t){var n=y.createElement("div");return n.textContent=e,n};e.renderGroup&&(l=e.renderGroup);var d=y.createDocumentFragment();if(N.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var n=l(t.group,k);n&&(n.className+=" group",d.appendChild(n))}var r=f(t,k);r&&(r.addEventListener("click",function(n){e.onSelect(t,h),i(),n.preventDefault(),n.stopPropagation()}),t===E&&(r.className+=" selected"),d.appendChild(r))}),x.appendChild(d),N.length<1){if(!e.emptyMsg)return void i();var a=y.createElement("div");a.className="empty",a.textContent=e.emptyMsg,x.appendChild(a)}n(),r(),s()}function l(){o()&&f()}function d(){l()}function a(){l()}function u(t){for(var n=t.which||t.keyCode||0,r=++H,l=[38,13,27,39,37,16,17,18,20,91,9],d=0,a=l;d<a.length;d++){if(n===a[d])return}if(40!==n||!o()){var u=h.value;u.length>=O?e.fetch(u,function(e){H===r&&e&&!w&&(N=e,k=u,E=N.length>0?N[0]:void 0,f())}):i()}}function s(){var e=x.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<x.scrollTop)x.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=x.scrollTop+x.offsetHeight;o>i&&(x.scrollTop+=o-i)}}}function c(){if(N.length<1)E=void 0;else if(E===N[0])E=N[N.length-1];else for(var e=N.length-1;e>0;e--)if(E===N[e]||1===e){E=N[e-1];break}}function p(){if(N.length<1&&(E=void 0),!E||E===N[N.length-1])return void(E=N[0]);for(var e=0;e<N.length-1;e++)if(E===N[e]){E=N[e+1];break}}function v(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var r=o();if(27===n)i();else{if(!o||N.length<1)return;38===n?c():p(),f()}return t.preventDefault(),void(r&&t.stopPropagation())}13===n&&E&&(e.onSelect(E,h),i())}function m(){setTimeout(function(){y.activeElement!==h&&i()},200)}function g(){w=!0,h.removeEventListener("keydown",v),h.removeEventListener(T,u),h.removeEventListener("blur",m),window.removeEventListener("resize",d),document.removeEventListener("scroll",a,!0),i()}var h,E,w,y=document,x=y.createElement("div"),C=x.style,L=navigator.userAgent,b=-1!==L.indexOf("Firefox")&&-1!==L.indexOf("Mobile"),T=b?"input":"keyup",N=[],k="",O=e.minLength||2,H=0;if(!e.input)throw new Error("input undefined");return h=e.input,x.className="autocomplete "+(e.className||""),C.position="absolute",r(),h.addEventListener("keydown",v),h.addEventListener(T,u),h.addEventListener("blur",m),window.addEventListener("resize",d),document.addEventListener("scroll",a,!0),{destroy:g}}return e});