!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){g++,h=[],u=void 0,v.display="none"}function n(){for(;c.firstChild;)c.removeChild(c.firstChild);var n=!1,o="#9?$";h.forEach(function(e){e.group&&(n=!0)});var r=function(e){var t=p.createElement("div");return t.textContent=e.label,t};e.render&&(r=e.render);var l=function(e){var t=p.createElement("div");return t.textContent=e,t};if(e.renderGroup&&(l=e.renderGroup),h.forEach(function(n){if(n.group&&n.group!==o){o=n.group;var i=l(n.group);i&&(i.className+=" group",c.appendChild(i))}var d=r(n);d&&(d.addEventListener("click",function(o){e.onSelect(n.item,f),t(),o.preventDefault(),o.stopPropagation()}),n===u&&(d.className+=" selected"),c.appendChild(d))}),h.length<1){if(!e.emptyMsg)return void t();var d=p.createElement("div");d.className="empty",d.textContent=e.emptyMsg,c.appendChild(d)}var s=f.getBoundingClientRect(),a=s.top+f.offsetHeight+p.body.scrollTop;v.top=a+"px",v.left=s.left+"px",v.width=f.offsetWidth+"px",v.maxHeight=window.innerHeight-(s.top+f.offsetHeight)+"px",v.height="auto",v.display="block",i()}function o(o){var i=o.which||o.keyCode||0,r=++g;38!==i&&13!==i&&27!==i&&39!==i&&37!==i&&0!==i&&(40===i&&"none"!==c.style.display||(f.value.length>=m?e.fetch(f.value,function(e){g===r&&e&&(h=e,u=h.length>0?h[0]:void 0,n())}):t()))}function i(){var e=c.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&n.className.indexOf("group")!==-1&&!n.previousElementSibling&&(t=n),t.offsetTop<c.scrollTop)c.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=c.scrollTop+c.offsetHeight;o>i&&(c.scrollTop+=o-i)}}}function r(){if(h.length<1)u=void 0;else if(u===h[0])u=h[h.length-1];else for(var e=h.length-1;e>0;e--)if(u===h[e]||1===e){u=h[e-1];break}}function l(){if(h.length<1&&(u=void 0),!u||u===h[h.length-1])return void(u=h[0]);for(var e=0;e<h.length-1;e++)if(u===h[e]){u=h[e+1];break}}function d(o){var i=o.which||o.keyCode||0;return 38===i||40===i||27===i?(o.preventDefault(),"none"!==c.style.display&&o.stopPropagation(),void(27===i?t():(38===i?r():l(),n()))):void(13===i&&u&&(e.onSelect(u.item,f),t()))}function s(){setTimeout(function(){p.activeElement!==f&&t()},200)}function a(){f.removeEventListener("keydown",d),f.removeEventListener("keyup",o),f.removeEventListener("focus",o),f.removeEventListener("blur",s),window.removeEventListener("resize",n),t();var e=c.parentNode;e&&e.removeChild(c)}var f,u,p=document,c=p.createElement("div"),v=c.style,h=[],m=e.minLength||2,g=0;if(!e.input)throw"input undefined";return f=e.input,p.body.appendChild(c),c.className="autocomplete "+(e.className||""),v.position="absolute",f.addEventListener("keydown",d),f.addEventListener("keyup",o),f.addEventListener("focus",o),f.addEventListener("blur",s),window.addEventListener("resize",n),{destroy:a}}return e});