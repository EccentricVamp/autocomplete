!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){y++,g=[],p=void 0,m.display="none"}function n(){for(;h.firstChild;)h.removeChild(h.firstChild);var n=!1,o="#9?$";g.forEach(function(e){e.group&&(n=!0)});var r=function(e){var t=c.createElement("div");return t.textContent=e.label,t};e.render&&(r=e.render);var l=function(e){var t=c.createElement("div");return t.textContent=e,t};if(e.renderGroup&&(l=e.renderGroup),g.forEach(function(n){if(n.group&&n.group!==o){o=n.group;var i=l(n.group);i&&(i.className+=" group",h.appendChild(i))}var d=r(n);d&&(d.addEventListener("click",function(o){e.onSelect(n.item,s),t(),o.preventDefault(),o.stopPropagation()}),n===p&&(d.className+=" selected"),h.appendChild(d))}),g.length<1){if(!e.emptyMsg)return void t();var d=c.createElement("div");d.className="empty",d.textContent=e.emptyMsg,h.appendChild(d)}var f=s.getBoundingClientRect(),a=f.top+s.offsetHeight+c.body.scrollTop;m.top=a+"px",m.left=f.left+"px",m.width=s.offsetWidth+"px",m.maxHeight=window.innerHeight-(f.top+s.offsetHeight)+"px",m.height="auto",m.display="block",i()}function o(o){var i=o.which||o.keyCode||0,r=++y;38!==i&&40!==i&&13!==i&&27!==i&&(s.value.length>=E?s.value!==v&&e.fetch(s.value,function(e){y===r&&e&&(g=e,p=g.length>0?g[0]:void 0,n())}):t(),v=s.value)}function i(){var e=h.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&n.className.indexOf("group")!==-1&&!n.previousElementSibling&&(t=n),t.offsetTop<h.scrollTop)h.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=h.scrollTop+h.offsetHeight;o>i&&(h.scrollTop+=o-i)}}}function r(){if(g.length<1)p=void 0;else if(p===g[0])p=g[g.length-1];else for(var e=g.length-1;e>0;e--)if(p===g[e]||1===e){p=g[e-1];break}}function l(){if(g.length<1&&(p=void 0),!p||p===g[g.length-1])return void(p=g[0]);for(var e=0;e<g.length-1;e++)if(p===g[e]){p=g[e+1];break}}function d(o){var i=o.which||o.keyCode||0;return 38===i||40===i||27===i?(27===i?t():(38===i?r():l(),n()),void o.preventDefault()):void(13===i&&p&&(e.onSelect(p.item,s),t()))}function f(){setTimeout(function(){c.activeElement!==s&&t()},100)}function a(){n()}function u(){s.removeEventListener("keydown",d),s.removeEventListener("keyup",o),s.removeEventListener("focus",o),s.removeEventListener("blur",f),window.removeEventListener("resize",a),t();var e=h.parentNode;e&&e.removeChild(h)}var s,p,v,c=document,h=c.createElement("div"),m=h.style,g=[],E=e.minLength||2,y=0;if(!e.input)throw"input undefined";return s=e.input,v=s.value,c.body.appendChild(h),h.className="autocomplete "+(e.className||""),m.position="absolute",s.addEventListener("keydown",d),s.addEventListener("keyup",o),s.addEventListener("focus",o),s.addEventListener("blur",f),window.addEventListener("resize",a),{destroy:u}}return e});