!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){return"none"!==m.display}function n(){w++,y=[],c=void 0,m.display="none"}function o(){for(;g.firstChild;)g.removeChild(g.firstChild);var t=!1,o="#9?$";y.forEach(function(e){e.group&&(t=!0)});var i=function(e){var t=h.createElement("div");return t.textContent=e.label,t};e.render&&(i=e.render);var r=function(e){var t=h.createElement("div");return t.textContent=e,t};if(e.renderGroup&&(r=e.renderGroup),y.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var l=r(t.group);l&&(l.className+=" group",g.appendChild(l))}var f=i(t);f&&(f.addEventListener("click",function(o){e.onSelect(t.item,p),n(),o.preventDefault(),o.stopPropagation()}),t===c&&(f.className+=" selected"),g.appendChild(f))}),y.length<1){if(!e.emptyMsg)return void n();var f=h.createElement("div");f.className="empty",f.textContent=e.emptyMsg,g.appendChild(f)}var a=p.getBoundingClientRect(),d=a.top+p.offsetHeight+h.body.scrollTop;m.top=d+"px",m.left=a.left+"px",m.width=p.offsetWidth+"px",m.maxHeight=window.innerHeight-(a.top+p.offsetHeight)+"px",m.height="auto",m.display="block",l()}function i(){t()&&o()}function r(i){for(var r=i.which||i.keyCode||0,l=++w,f=[38,13,27,39,37,16,17,18,20,91,9],a=0,d=f;a<d.length;a++){if(r===d[a])return}40===r&&t()||(p.value.length>=E?e.fetch(p.value,function(e){w===l&&e&&!v&&(y=e,c=y.length>0?y[0]:void 0,o())}):n())}function l(){var e=g.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<g.scrollTop)g.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=g.scrollTop+g.offsetHeight;o>i&&(g.scrollTop+=o-i)}}}function f(){if(y.length<1)c=void 0;else if(c===y[0])c=y[y.length-1];else for(var e=y.length-1;e>0;e--)if(c===y[e]||1===e){c=y[e-1];break}}function a(){if(y.length<1&&(c=void 0),!c||c===y[y.length-1])return void(c=y[0]);for(var e=0;e<y.length-1;e++)if(c===y[e]){c=y[e+1];break}}function d(i){var r=i.which||i.keyCode||0;if(38===r||40===r||27===r){var l=t();if(27===r)n();else{if(!t||y.length<1)return;38===r?f():a(),o()}return i.preventDefault(),void(l&&i.stopPropagation())}13===r&&c&&(e.onSelect(c.item,p),n())}function s(){setTimeout(function(){h.activeElement!==p&&n()},200)}function u(){v=!0,p.removeEventListener("keydown",d),p.removeEventListener("keyup",r),p.removeEventListener("blur",s),window.removeEventListener("resize",i),n();var e=g.parentNode;e&&e.removeChild(g)}var p,c,v,h=document,g=h.createElement("div"),m=g.style,y=[],E=e.minLength||2,w=0;if(!e.input)throw new Error("input undefined");return p=e.input,h.body.appendChild(g),g.className="autocomplete "+(e.className||""),m.position="absolute",m.display="none",p.addEventListener("keydown",d),p.addEventListener("keyup",r),p.addEventListener("blur",s),window.addEventListener("resize",i),{destroy:u}}return e});