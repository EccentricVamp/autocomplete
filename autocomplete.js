!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){var e=w.parentNode;e&&e.removeChild(w)}function n(){w.parentNode||C.body.appendChild(w)}function o(){return!!w.parentNode}function r(){k++,L=[],b="",E=void 0,t()}function i(){var e=g.getBoundingClientRect(),t=e.top+g.offsetHeight+(C.documentElement?C.documentElement.scrollTop:0);x.top=t+"px",x.left=e.left+"px",x.width=g.offsetWidth+"px",x.maxHeight=window.innerHeight-(e.top+g.offsetHeight)+"px",x.height="auto"}function l(){for(;w.firstChild;)w.removeChild(w.firstChild);var t=!1,o="#9?$";L.forEach(function(e){e.group&&(t=!0)});var l=function(e,t){var n=C.createElement("div");return n.textContent=e.label||"",n};e.render&&(l=e.render);var f=function(e,t){var n=C.createElement("div");return n.textContent=e,n};e.renderGroup&&(f=e.renderGroup);var d=C.createDocumentFragment();if(L.forEach(function(t){if(t.group&&t.group!==o){o=t.group;var n=f(t.group,b);n&&(n.className+=" group",d.appendChild(n))}var i=l(t,b);i&&(i.addEventListener("click",function(n){e.onSelect(t,g),r(),n.preventDefault(),n.stopPropagation()}),t===E&&(i.className+=" selected"),d.appendChild(i))}),w.appendChild(d),L.length<1){if(!e.emptyMsg)return void r();var u=C.createElement("div");u.className="empty",u.textContent=e.emptyMsg,w.appendChild(u)}n(),i(),s()}function f(){o()&&l()}function d(){f()}function u(){f()}function a(t){for(var n=t.which||t.keyCode||0,i=++k,f=[38,13,27,39,37,16,17,18,20,91,9],d=0,u=f;d<u.length;d++){if(n===u[d])return}if(40!==n||!o()){var a=g.value;a.length>=N?e.fetch(a,function(e){k===i&&e&&!y&&(L=e,b=a,E=L.length>0?L[0]:void 0,l())}):r()}}function s(){var e=w.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<w.scrollTop)w.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,r=w.scrollTop+w.offsetHeight;o>r&&(w.scrollTop+=o-r)}}}function c(){if(L.length<1)E=void 0;else if(E===L[0])E=L[L.length-1];else for(var e=L.length-1;e>0;e--)if(E===L[e]||1===e){E=L[e-1];break}}function p(){if(L.length<1&&(E=void 0),!E||E===L[L.length-1])return void(E=L[0]);for(var e=0;e<L.length-1;e++)if(E===L[e]){E=L[e+1];break}}function v(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var i=o();if(27===n)r();else{if(!o||L.length<1)return;38===n?c():p(),l()}return t.preventDefault(),void(i&&t.stopPropagation())}13===n&&E&&(e.onSelect(E,g),r())}function m(){setTimeout(function(){C.activeElement!==g&&r()},200)}function h(){y=!0,g.removeEventListener("keydown",v),g.removeEventListener("keyup",a),g.removeEventListener("blur",m),window.removeEventListener("resize",d),document.removeEventListener("scroll",u,!0),r()}var g,E,y,C=document,w=C.createElement("div"),x=w.style,L=[],b="",N=e.minLength||2,k=0;if(!e.input)throw new Error("input undefined");return g=e.input,w.className="autocomplete "+(e.className||""),x.position="absolute",i(),g.addEventListener("keydown",v),g.addEventListener("keyup",a),g.addEventListener("blur",m),window.addEventListener("resize",d),document.addEventListener("scroll",u,!0),{destroy:h}}return e});